function doPost(e) {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheet = ss.getSheets()[0];
  var data = JSON.parse(e.postData.contents);
  
  // 1. Log the text data to the Sheet (Original Logic)
  sheet.appendRow([
    new Date(), 
    data.title, 
    data.staff, 
    data.text, 
    data.date
  ]);
  
  // 2. Save Audio to Google Drive (New Logic)
  if (data.audioData) {
    try {
      // Decode the base64 audio string
      var contentType = data.audioMime || "audio/wav";
      var audioBlob = Utilities.newBlob(
        Utilities.base64Decode(data.audioData), 
        contentType, 
        (data.title || "Recording") + ".wav"
      );
      
      // Save to your root Drive (or use .getFolderById("ID") to save to a specific folder)
      var file = DriveApp.createFile(audioBlob);
      
      // Optional: Put the link to the audio file in the next column of your sheet
      var lastRow = sheet.getLastRow();
      sheet.getRange(lastRow, 6).setValue(file.getUrl());
      
    } catch (err) {
      console.log("Audio save failed: " + err.toString());
    }
  }
  
  return ContentService.createTextOutput("Success");
}
